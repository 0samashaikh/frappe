{% macro render_field(df, doc) %}
	{% if df.fieldtype == 'Table' %}
		{{ render_table(df, doc) }}
	{% elif df.fieldtype == 'HTML' %}
		{{ render_custom_html(df, doc) }}
	{% else %}
		{% if doc.get(fieldname) %}
		<div class="field">
			<div class="label" {{ field_attributes(df) }}>
				{{ df.label }}
			</div>
			<div class="value" {{ field_attributes(df) }}>
				{{ doc.get_formatted(df.fieldname) }}
			</div>
		</div>
		{% endif %}
	{% endif %}
{% endmacro %}

{% macro field_attributes(df) %}
{%- if df.fieldname -%}
data-fieldname="{{ df.fieldname }}"
{%- endif %}
{% if df.fieldtype -%}
data-fieldtype="{{ df.fieldtype }}"
{%- endif -%}
{% endmacro %}

{% macro render_table(df, doc) %}
{% if doc.get(df.fieldname) %}
<div class="child-table" {{ field_attributes(df) }}>
	<div class="label">
		{{ df.label }}
	</div>
	<table class="table">
		{% set columns = df.table_columns %}
		<thead>
			<tr class="table-row">
				{% for column in columns %}
				<th class="column-header" width="{{ column.width }}%" {{ field_attributes(column) }}>
					{{ column.label }}
				</th>
				{% endfor %}
			</tr>
		</thead>
		<tbody>
			{% for row in doc.get(df.fieldname) %}
			<tr class="table-row {{ loop.cycle('odd', 'even') }}" data-idx="{{ row.idx }}">
				{% for column in columns %}
				<td class="column-value" width="{{ column.width }}%" {{ field_attributes(column) }}>
					{{ row.get_formatted(column.fieldname) }}
				</td>
				{% endfor %}
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endif %}
{% endmacro %}

{% macro render_custom_html(df, doc) %}
<div class="custom-html">
	{{ frappe.render_template(df.html, {'doc': doc}) }}
</div>
{% endmacro %}

